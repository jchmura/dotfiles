#compdef torrent
 
typeset -A opt_args

_arguments -C \
  '1:cmd:->cmds' \
  '2:args:->args' \
&& ret=0

case $state in
    "cmds")
        local commands; commands=(
        'start:start transmission-daemon'
        'stop:stop transmission-daemon'
        'list:list torrents'
        'list-undone:list undone torrents'
        'info:info about downloading torrents'
        'add:add a new torrent'
        )

        _describe -t commands 'command' commands && ret=0
        ;;
    "args")
        if [ $line[1] = "add" ];then
            _arguments "2:magnet or torrent:_files -g \*.torrent" && ret=0
        fi
esac

return ret